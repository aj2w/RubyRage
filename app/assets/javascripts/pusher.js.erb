
// Enable pusher logging - don't include this in production
Pusher.log = function(message) {
  if (window.console && window.console.log) {
    window.console.log(message);
  }
};

var pusher = new Pusher('<%= Pusher.key %>');
var channel = pusher.subscribe('rubyrage_thomas');

channel.bind('my_event', function(data) {
  alert(data.message)
});

channel.bind('gameBroadcast', function(rawGameboardData) {
  var atOpponentGameboard = rubyRageBattleMode.returnCtxOpponentGameboard();
  var reassembledGameboard = rubyRageBattleMode.reAssembleGameboard(rawGameboardData);
  rubyRageBattleMode.renderOpponentsSittingRubymons( reassembledGameboard, atOpponentGameboard);
});

//////////////////////////////////////////////////////////////////////////////
// PUSHER RELATED EVENTS & FUNCTIONS
//////////////////////////////////////////////////////////////////////////////

$('#battle-button').click(function(){
  // startSendingRequest();
  setInterval(startSendingRequest, 100);
})

function startSendingRequest() {
  $.ajax({
    url: "/games/startBroadcasting",
    type: "post",
    dataType: "json",
    data: {"mySittingRubymonsPosition": gameboardInplay,
           "mySittingRubymonsPosition"}
  })
}


