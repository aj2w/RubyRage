
// Enable pusher logging - don't include this in production
Pusher.log = function(message) {
  if (window.console && window.console.log) {
    window.console.log(message);
  }
};


var pusher = new Pusher('<%= Pusher.key %>');
var socketId = null;

var username = $('.menubar_user').text();
var usernameWithNoSpaces = username.replace(/^\s+|\s+$/g, "");
var channel = pusher.subscribe(usernameWithNoSpaces);

channel.bind('my_event', function(data) {
  $('#opponent').append(data.message);
});

$('#battle-button').click(function(){
  setInterval(startSendingRequest, 1000);
})

var tempchannelname = $('#channel-name').text();
var channelname = tempchannelname.replace(/^\s+|\s+$/g, "");

function startSendingRequest() {
  $.ajax({
    url: "/games/pusher",
    type: "get",
    data: "json"
  })
}